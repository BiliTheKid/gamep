<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dodge Game - Playable Ad</title>
    <script src="https://pixijs.download/v7.3.2/pixi.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            overflow: hidden;
            background-color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            touch-action: none;
        }

        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
            max-width: 800px;
            max-height: 600px;
            touch-action: none;
        }

        #cta-button {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            z-index: 1000;
            display: none;
        }

        #cta-button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div id="gameContainer"></div>
    <button id="cta-button">Install Now!</button>

<script>
// Game code
(function() {
    // Create the application
    const app = new PIXI.Application({
        width: 800,
        height: 600,
        backgroundColor: 0x1099bb,
        resizeTo: document.getElementById('gameContainer')
    });

    document.getElementById('gameContainer').appendChild(app.view);

    // Create player sprite
    const player = PIXI.Sprite.from('https://pixijs.io/examples/examples/assets/bunny.png');
    player.anchor.set(0.5);
    player.x = app.screen.width / 2;
    player.y = app.screen.height / 2;
    app.stage.addChild(player);

    // Balls array and constants
    const balls = [];
    const ballCount = 5;
    const ballRadius = 10;
    const ballSpeed = 3;

    // Create multiple balls
    for (let i = 0; i < ballCount; i++) {
        const ball = new PIXI.Graphics();
        ball.beginFill(0xff0000);
        ball.drawCircle(0, 0, ballRadius);
        ball.endFill();
        
        ball.x = Math.random() * app.screen.width;
        ball.y = Math.random() * app.screen.height;
        
        const angle = Math.random() * Math.PI * 2;
        const speedX = Math.cos(angle) * ballSpeed;
        const speedY = Math.sin(angle) * ballSpeed;
        
        balls.push({
            graphic: ball,
            speedX,
            speedY
        });
        
        app.stage.addChild(ball);
    }

    // Movement variables
    const speed = 5;
    const keys = {};
    let isGameOver = false;

    // Touch controls
    let touchPosition = null;
    app.view.addEventListener('touchstart', handleTouchStart);
    app.view.addEventListener('touchmove', handleTouchMove);
    app.view.addEventListener('touchend', handleTouchEnd);

    function handleTouchStart(e) {
        e.preventDefault();
        touchPosition = { x: e.touches[0].clientX, y: e.touches[0].clientY };
    }

    function handleTouchMove(e) {
        e.preventDefault();
        if (!touchPosition || isGameOver) return;

        const newX = e.touches[0].clientX;
        const newY = e.touches[0].clientY;

        const deltaX = newX - touchPosition.x;
        const deltaY = newY - touchPosition.y;

        player.x += deltaX * 0.5;
        player.y += deltaY * 0.5;

        touchPosition = { x: newX, y: newY };
    }

    function handleTouchEnd() {
        touchPosition = null;
    }

    // Keyboard controls
    window.addEventListener('keydown', (e) => {
        keys[e.key] = true;
    });

    window.addEventListener('keyup', (e) => {
        keys[e.key] = false;
    });

    // Collision detection
    function checkCollision(player, ball) {
        const dx = player.x - ball.x;
        const dy = player.y - ball.y;
        const distance = Math.sqrt(dx * dx + dy * dy);
        return distance < (player.width / 2 + ballRadius);
    }

    // Create alert overlay
    function createAlert() {
        const alertContainer = new PIXI.Container();
        
        const overlay = new PIXI.Graphics();
        overlay.beginFill(0x000000, 0.7);
        overlay.drawRect(0, 0, app.screen.width, app.screen.height);
        overlay.endFill();
        alertContainer.addChild(overlay);
        
        const alertText = new PIXI.Text('Game Over!', {
            fontFamily: 'Arial',
            fontSize: 48,
            fill: 0xff0000,
            align: 'center'
        });
        alertText.anchor.set(0.5);
        alertText.x = app.screen.width / 2;
        alertText.y = app.screen.height / 2 - 50;
        alertContainer.addChild(alertText);

        // Show CTA button
        document.getElementById('cta-button').style.display = 'block';
        
        return alertContainer;
    }

    // Game loop
    app.ticker.add(() => {
        if (isGameOver) return;

        // Keyboard movement
        if (keys['ArrowLeft']) player.x -= speed;
        if (keys['ArrowRight']) player.x += speed;
        if (keys['ArrowUp']) player.y -= speed;
        if (keys['ArrowDown']) player.y += speed;
        
        // Keep player within bounds
        player.x = Math.max(player.width / 2, Math.min(app.screen.width - player.width / 2, player.x));
        player.y = Math.max(player.height / 2, Math.min(app.screen.height - player.height / 2, player.y));

        // Update balls
        for (const ball of balls) {
            ball.graphic.x += ball.speedX;
            ball.graphic.y += ball.speedY;

            if (ball.graphic.x <= ballRadius || ball.graphic.x >= app.screen.width - ballRadius) {
                ball.speedX *= -1;
            }
            if (ball.graphic.y <= ballRadius || ball.graphic.y >= app.screen.height - ballRadius) {
                ball.speedY *= -1;
            }

            if (checkCollision(player, ball.graphic)) {
                isGameOver = true;
                app.stage.addChild(createAlert());
            }
        }
    });

    // CTA button click handler
    document.getElementById('cta-button').addEventListener('click', function() {
        // Add your ad platform's click-through URL here
        window.open('YOUR_STORE_URL_HERE', '_blank');
    });

    // Handle window resize
    window.addEventListener('resize', function() {
        const container = document.getElementById('gameContainer');
        const scale = Math.min(
            container.clientWidth / 800,
            container.clientHeight / 600
        );
        
        app.view.style.transform = `scale(${scale})`;
        app.view.style.transformOrigin = 'center';
    });
})();
</script>
</body>
</html> 